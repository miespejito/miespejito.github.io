<!DOCTYPE html>
<html>

    <head>
        <title>Mi Espejito</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- Bootstrap core CSS -->
        <link href="bs/css/bootstrap.min.css" rel="stylesheet">
    </head>

    <body>

        <!-- Fixed navbar -->
        <div class="navbar navbar-inverse navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                         <span class="icon-bar"></span>
                         <span class="icon-bar"></span>
                         <span class="icon-bar"></span>
                    </button>
                     <a class="navbar-brand" href="#">Mi Espejito</a>
                </div>
            </div>
        </div>

        <div class="container theme-showcase">

            <!-- Main jumbotron for a primary marketing message or call to action -->
            <div class="jumbotron">
                 <h1>¿Quién era la más bella de todas?</h1>
                <p class="lead">La alternativa perfecta a tu espejo</p>
                <p><a class="btn btn-primary" id="freeze" href="#" role="button">Congelar</a>
                     <a class="btn btn-primary" id="shot" href="#" role="button">Guardar</a>
                     <a class="btn btn-primary" id="shotplus" href="#" role="button">Photobooth!</a>
                </p>
            </div>

            <div id="espejo">
                <video id="video" width="640" height="480" autoplay></video>
                <canvas id="canvas" width="640" height="480" style=display:none></canvas>

                <script>
                    // Put event listeners into place
                    window.addEventListener("DOMContentLoaded", function() {
                        // Grab elements, create settings, etc.
                        var canvas = document.getElementById("canvas");
                        var video = document.getElementById("video");
                        var videoConstraint = {
                            "video": true
                        };
                        var errBack = function(error) {
                            // TODO: Replace video by error.
                            console.log("Video error: ", error.name);
                        };

                        // Put video listeners into place
                        if (navigator.getUserMedia) { // Standard
                            navigator.getUserMedia(videoConstraint, function(stream) {
                                video.src = stream;
                                video.play();
                            }, errBack);
                        } else if (navigator.webkitGetUserMedia) { // WebKit-prefixed
                            navigator.webkitGetUserMedia(videoConstraint, function(stream) {
                                video.src = window.webkitURL.createObjectURL(stream);
                                video.play();
                            }, errBack);
                        } else if (navigator.mozGetUserMedia) { // Firefox-prefixed
                            navigator.mozGetUserMedia(videoConstraint, function(stream) {
                                video.src = window.URL.createObjectURL(stream);
                                video.play();
                            }, errBack);
                        }
                    }, false);

                    document.getElementById("freeze").addEventListener("click", function() {
                        canvas.style.display = "none";
                        video.style.display = "";
                        if (video.paused) {
                            video.play()
                        } else {
                            video.pause()
                        }
                    });

                    document.getElementById("shot").addEventListener("click", function() {
                        canvas.style.display = "";
                        video.style.display = "none";
                        canvas.height = 480;
                        canvas.getContext("2d").drawImage(video, 0, 0, 640, 480);
                    });

                    document.getElementById("shotplus").addEventListener("click", function() {
                        var delay = 1000;
                        canvas.height = 1;
                        canvas.style.display = "";
                        video.style.display = "none";
                        video.play()


                        function shot(i) {
                            if (i <= 0) {
                                return;
                            }
                            var tmp = document.createElement('canvas');
                            tmp.width = canvas.width;
                            tmp.height = canvas.height;
                            tmp.getContext("2d").drawImage(canvas, 0, 0);
                            canvas.height += 480;
                            canvas.getContext("2d").drawImage(video, 0, 0, 640, 480);
                            canvas.getContext("2d").drawImage(tmp, 0, 480, 640, tmp.height);
                            setTimeout(function() {
                                shot(i - 1)
                            }, delay);
                        }

                        setTimeout(function() {
                            shot(4)
                        }, delay);
                    });
                </script>


            </div>


            <div class="page-header">
                 <h1>Panels</h1>
            </div>
            <div class="row">
                <div class="col-sm-4">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                             <h3 class="panel-title">Panel title</h3>
                        </div>
                        <div class="panel-body">Panel content
                        </div>
                    </div>
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                             <h3 class="panel-title">Panel title</h3>
                        </div>
                        <div class="panel-body">Panel content
                        </div>
                    </div>
                </div>
                <!-- /.col-sm-4 -->
                <div class="col-sm-4">
                    <div class="panel panel-success">
                        <div class="panel-heading">
                             <h3 class="panel-title">Panel title</h3>
                        </div>
                        <div class="panel-body">Panel content
                        </div>
                    </div>
                    <div class="panel panel-info">
                        <div class="panel-heading">
                             <h3 class="panel-title">Panel title</h3>
                        </div>
                        <div class="panel-body">Panel content
                        </div>
                    </div>
                </div>
                <!-- /.col-sm-4 -->
                <div class="col-sm-4">
                    <div class="panel panel-warning">
                        <div class="panel-heading">
                             <h3 class="panel-title">Panel title</h3>
                        </div>
                        <div class="panel-body">Panel content
                        </div>
                    </div>
                    <div class="panel panel-danger">
                        <div class="panel-heading">
                             <h3 class="panel-title">Panel title</h3>
                        </div>
                        <div class="panel-body">Panel content
                        </div>
                    </div>
                </div>
                <!-- /.col-sm-4 -->
            </div>



            <div class="page-header">
                 <h1>Wells</h1>
            </div>
            <div class="well">
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas sed diam eget risus varius blandit sit amet non magna. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent commodo cursus magna, vel scelerisque nisl consectetur
                    et. Cras mattis consectetur purus sit amet fermentum. Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem nec elit. Aenean lacinia bibendum nulla sed consectetur.</p>
            </div>


        </div>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
        <script src="http://getbootstrap.com/dist/js/bootstrap.min.js"></script>
        <script src="http://getbootstrap.com/assets/js/docs.min.js"></script>
    </body>

</html>
